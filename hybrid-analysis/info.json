{
  "name": "hybrid-analysis",
  "version": "2.0.1",
  "label": "Hybrid Analysis",
  "description": "Hybrid Analysis provides a malware analysis service that allows users to automate the analysis of files and URLs for potential threats. This connector facilitates automated operations such as retrieving analysis reports, environment details, submitting files, submitting URLs, etc.",
  "publisher": "Fortinet",
  "icon_small_name": "Hybrid_Analysis_small.png",
  "icon_large_name": "Hybrid_Analysis_medium.png",
  "category": "Malware Analysis",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "server_url",
        "value": "https://www.hybrid-analysis.com",
        "description": "URL of the Hybrid Analysis server to which you will connect and perform the automated operations.",
        "tooltip": "URL of the Hybrid Analysis server to which you will connect and perform the automated operations."
      },
      {
        "title": "API Key",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "api_key",
        "description": "API key that is configured for your account to access the Hybrid Analysis endpoint.",
        "tooltip": "API key that is configured for your account to access the Hybrid Analysis endpoint."
      },
      {
        "title": "Verify SSL",
        "name": "verify_ssl",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not.",
        "tooltip": "Specifies whether the SSL certificate for the server is to be verified or not."
      }
    ]
  },
  "operations": [
    {
      "operation": "hashes_search",
      "title": "Get Analysis Report for Multiple Hashcodes",
      "category": "investigation",
      "annotation": "get_analysis_report_for_multiple_hashcodes",
      "description": "Retrieves the analysis report summary from the Hybrid Analysis server for multiple MD5/SHA1/SHA256 hash codes you have specified.",
      "parameters": [
        {
          "title": "Hash Codes",
          "name": "hashcodes",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Either one md5/sha1/sha256 hash or several of them in CSV format",
          "description": "Specify the hash codes in the MD5, SHA256, or SHA1 format whose summary you want to retrieve from the Hybrid Analysis server. You can specify multiple codes in the CSV format.",
          "placeholder": "d41d8cd98f00b204e9800998ecf8427e,gwerfdc98f00b204e9810998ecf8427e"
        }
      ],
      "enabled": true,
      "output_schema": [
        {
          "job_id": "",
          "environment_id": "",
          "environment_description": "",
          "size": "",
          "type": "",
          "type_short": [],
          "target_url": "",
          "state": "",
          "error_type": "",
          "error_origin": "",
          "submit_name": "",
          "md5": "",
          "sha1": "",
          "sha256": "",
          "sha512": "",
          "ssdeep": "",
          "imphash": "",
          "av_detect": "",
          "vx_family": "",
          "url_analysis": "",
          "analysis_start_time": "",
          "threat_score": "",
          "interesting": "",
          "threat_level": "",
          "verdict": "",
          "certificates": [],
          "domains": [],
          "classification_tags": [],
          "compromised_hosts": [],
          "hosts": [],
          "total_network_connections": "",
          "total_processes": "",
          "total_signatures": "",
          "extracted_files": [],
          "file_metadata": "",
          "processes": [],
          "tags": [],
          "mitre_attcks": [],
          "submissions": [
            {
              "submission_id": "",
              "filename": "",
              "url": "",
              "created_at": ""
            }
          ],
          "network_mode": "",
          "machine_learning_models": []
        }
      ]
    },
    {
      "operation": "get_environment",
      "title": "Get Environment",
      "category": "investigation",
      "annotation": "get_environment",
      "description": "Retrieves all the sandbox information from the Hybrid Analysis server.",
      "parameters": [],
      "enabled": true,
      "output_schema": [
        {
          "id": "",
          "environment_id": "",
          "description": "",
          "group_icon": "",
          "architecture": "",
          "analysis_mode": "",
          "virtual_machines": [],
          "total_virtual_machines": "",
          "busy_virtual_machines": "",
          "invalid_virtual_machines": ""
        }
      ]
    },
    {
      "operation": "submit_file",
      "title": "Submit File",
      "category": "investigation",
      "annotation": "detonate_file",
      "description": "Submits a file from the FortiSOAR™ Attachments/Indicators module to the Hybrid Analysis server for analysis.",
      "parameters": [
        {
          "title": "Attachment/Indicator ID",
          "name": "value",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "description": "The ID of the file that you want to submit to the Hybrid Analysis server. The file ID is used to access the file from the 'Attachments' or 'Indicators' module of FortiSOAR™.",
          "tooltip": "The ID of the file that you want to submit to the Hybrid Analysis server. The file ID is used to access the file from the 'Attachments' or 'Indicators' module of FortiSOAR™."
        },
        {
          "title": "Environment ID",
          "name": "environment_id",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "e.g 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’",
          "placeholder": "300",
          "description": "The ID of the environment in which the file is to be run.\nFor example, 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’.\nAvailable environment IDs are: 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’, 120: 'Windows 7 64 bit’, 110: 'Windows 7 32 bit (HWP Support)', or 100: ‘Windows 7 32 bit’."
        },
        {
          "title": "Priority",
          "name": "priority",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "Priority value between 0 (default) and 100 (highest)",
          "placeholder": "80",
          "description": "The priority value of the sample. By default, the Priority is set to, 0. You can set this value to any value between 0 and 100, which is the highest value."
        },
        {
          "title": "Action Script",
          "name": "action_script",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Default",
            "Default Maxium Antievasion",
            "Default Random Files",
            "Default Random Theme",
            "Default Openie"
          ],
          "tooltip": "Custom runtime action script. Available runtime scripts are following",
          "placeholder": "Default",
          "description": "(Optional) Select a custom runtime action script.Available custom runtime action script are as follows: Default, Default Maximum Antievasion, Default Random Files, Default Random Theme, or Default Openie."
        },
        {
          "title": "Network Settings",
          "name": "network_settings",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Default",
            "Tor",
            "Simulated"
          ],
          "tooltip": "Network settings, by the default, fully operating network is set.",
          "placeholder": "Default",
          "description": "(Optional) Select a network settings.Available network settings are as follows: Default, Tor, or Simulated."
        },
        {
          "title": "Required Memory Dump?",
          "name": "hybrid_analysis",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": true,
          "tooltip": "When set to 'false’, no memory dumps or memory dump analysis will take place",
          "description": "If you select this option, i.e set it to,True then memory dumps or memory analysis dumps will occur.By default, this is set to, True."
        },
        {
          "title": "Experimental Anti-Evasion?",
          "name": "experimental_anti_evasion",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to 'true’, will set all experimental anti-evasion options of the kernelmode Monitor",
          "description": "If you select this option, i.e set it to, True,enables all the experimental anti-evasion options of the kernelmode Monitor.By default, this is set toFalse"
        },
        {
          "title": "Set the IN-Depth Script Logging",
          "name": "script_logging",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to 'true’, will set the in-depth script logging engine of the kernelmode Monitor",
          "description": "If you select this option, i.e set it to,True enables the in-depth script logging engine of the kernelmode Monitor.By default, this is set to, False."
        },
        {
          "title": "Allow Sample Tampering",
          "name": "input_sample_tampering",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to 'true’, will allow experimental anti-evasion options of the kernelmode Monitor that tamper with the input sample",
          "description": "If you select this option, i.e set it to,True enables the experimental anti-evasion options of the kernelmode Monitor that tamper with the input sample.By default, this is set to, False."
        },
        {
          "title": "Email Notification",
          "name": "email",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "E-Mail address that may be associated with the submission for notification",
          "placeholder": "hswdbv@gmail.com",
          "description": "(Optional) Email Address that is associated with the file that you have submitted for submission. This email address will be used for notification purposes."
        },
        {
          "title": "Comment",
          "name": "comment",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Comment text that may be associated with the submission/sample (Note: you can use #tags here)",
          "placeholder": "#tags",
          "description": "(Optional) A comment that you want to add when submitting the file."
        },
        {
          "title": "Custom Date Time for the Analysis System",
          "name": "custom_date_time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "tooltip": "Custom date/time that can be set for the analysis system",
          "description": "(Optional) The Custom date and time that you can set for the analysis system."
        },
        {
          "title": "Custom CMD Line Pass to the Analysis File",
          "name": "custom_cmd_line",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Commandline that should be passed to the analysis file",
          "description": "(Optional) The custom command line that you want to pass to the analysis file."
        },
        {
          "title": "Custom Run Time",
          "name": "custom_run_time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "Runtime duration (in seconds). Note: Time should be in between 30 to 360 sec.",
          "placeholder": "100",
          "description": "(Optional) The runtime duration that you can specify in seconds. Note: Time should be in between 30 to 360 sec."
        },
        {
          "title": "Submit Name",
          "name": "submit_name",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Submission Name field that will be used for file type detection and analysis",
          "placeholder": "My Sample",
          "description": "(Optional) The name of the submitted file. The Submission Name field is used for file type detection and analysis."
        },
        {
          "title": "Document Password",
          "name": "document_password",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "password",
          "tooltip": "Document password that will be used to fill-in Adobe/Office password prompts",
          "description": "(Optional) The password of the document is used to fill in Adobe or Office password prompts."
        },
        {
          "title": "Environment Variable (Format name=value)",
          "name": "environment_variable",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "System environment value. The value is provided in the format: name=value",
          "placeholder": "name=value",
          "description": "(Optional) The system environment value. You must provide this value in the name=value format."
        }
      ],
      "enabled": true,
      "output_schema": {
        "job_id": "",
        "environment_id": "",
        "submission_id": "",
        "sha256": ""
      }
    },
    {
      "operation": "submit_url",
      "title": "Submit URL",
      "category": "investigation",
      "annotation": "submit_url",
      "description": "Submits a URL to the Hybrid Analysis server for analysis.",
      "parameters": [
        {
          "title": "URL",
          "name": "url",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "Specify the URL that you want to submit to the Hybrid Analysis server.",
          "tooltip": "Specify the URL that you want to submit to the Hybrid Analysis server."
        },
        {
          "title": "Environment ID",
          "name": "environment_id",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "e.g 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’",
          "placeholder": "300",
          "value": 300,
          "description": "The ID of the environment in which the URL is to be run.\nFor example, 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’.\nAvailable environment IDs are: 300: 'Linux (Ubuntu 16.04, 64 bit)', 200: 'Android Static Analysis’, 120: 'Windows 7 64 bit’, 110: 'Windows 7 32 bit (HWP Support)', or 100: ‘Windows 7 32 bit’."
        },
        {
          "title": "Priority",
          "name": "priority",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "Priority value between 1 (default) and 100 (highest)",
          "placeholder": "1",
          "value": 1,
          "description": "(Optional) The priority value of the sample URL. By default, all URL samples are set to run with the highest priority i.e., 100. You can set this value to any value between 1 (lowest) and 100(highest)."
        },
        {
          "title": "Action Script",
          "name": "action_script",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "default",
            "default_maxantievasion",
            "default_randomfiles",
            "default_randomtheme",
            "default_openie"
          ],
          "tooltip": "Custom runtime action script. Available runtime scripts are following",
          "placeholder": "default",
          "description": "(Optional) Select a custom runtime action script.Available custom runtime action script are as follows: default, default_maxantievasion, default_randomfiles, default_randomtheme, or default_openie."
        },
        {
          "title": "Required Memory Dump?",
          "name": "hybrid_analysis",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": true,
          "tooltip": "When set to 'false’, no memory dumps or memory dump analysis will take place",
          "description": "If you select this option, i.e set it to,True then memory dumps or memory analysis dumps will occur.By default, this is set to, True."
        },
        {
          "title": "Experimental Anti-Evasion?",
          "name": "experimental_anti_evasion",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to true, will set all experimental anti-evasion options of the kernelmode Monitor",
          "description": "If you select this option, i.e set it to, True,enables all the experimental anti-evasion options of the kernelmode Monitor.By default, this is set toFalse"
        },
        {
          "title": "Set the IN-Depth Script Logging",
          "name": "script_logging",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to true, will set the in-depth script logging engine of the kernelmode Monitor",
          "description": "If you select this option, i.e set it to,True enables the in-depth script logging engine of the kernelmode Monitor.By default, this is set to, False."
        },
        {
          "title": "Allow Sample Tampering",
          "name": "input_sample_tampering",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When set to true, will allow experimental anti-evasion options of the kernelmode Monitor that tamper with the input sample",
          "description": "If you select this option, i.e set it to,True enables the experimental anti-evasion options of the kernelmode Monitor that tamper with the input sample.By default, this is set to, False."
        },
        {
          "title": "Network Settings",
          "name": "network_settings",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Default",
            "Tor",
            "Simulated"
          ],
          "tooltip": "Network settings, by the default, fully operating network is set.",
          "placeholder": "Default",
          "description": "(Optional) Select a network settings.Available network settings are as follows: Default, Tor, or Simulated."
        },
        {
          "title": "Email Notification",
          "name": "email",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "E-Mail address that may be associated with the submission for notification",
          "placeholder": "hswdbv@gmail.com",
          "description": "(Optional) Specify the email addresses that are associated with the URL that you have submitted for analysis. This email address will be used for notification purposes."
        },
        {
          "title": "Comment",
          "name": "comment",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "(Optional) A comment that you want to add when submitting the URL.\nNote: You can use #tags while entering comments.",
          "placeholder": "#tags"
        },
        {
          "title": "Custom Date Time for the Analysis System",
          "name": "custom_date_time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "tooltip": "Custom date/time that can be set for the analysis system",
          "description": "(Optional) The Custom date and time that you can set for the analysis system."
        },
        {
          "title": "Custom CMD Line Pass to the Analysis File",
          "name": "custom_cmd_line",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Commandline that should be passed to the analysis file",
          "description": "(Optional) The custom command line that you want to pass to the analysis file."
        },
        {
          "title": "Custom Run Time",
          "name": "custom_run_time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "Runtime duration (in seconds). Note: Time should be in between 30 to 360 sec.",
          "placeholder": "100",
          "description": "(Optional) The runtime duration that you can specify in seconds. Note: Time should be in between 30 to 360 sec."
        },
        {
          "title": "Submit Name",
          "name": "submit_name",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Submission Name field that will be used for file type detection and analysis",
          "placeholder": "My Sample",
          "description": "(Optional) The name of the submitted file. The Submission Name field is used for file type detection and analysis."
        },
        {
          "title": "Document Password",
          "name": "document_password",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "password",
          "tooltip": "Document password that will be used to fill-in Adobe/Office password prompts",
          "description": "(Optional) The password of the document is used to fill in Adobe or Office password prompts."
        },
        {
          "title": "Environment Variable (Format name=value)",
          "name": "environment_variable",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "System environment value. The value is provided in the format: name=value",
          "placeholder": "name=value",
          "description": "(Optional) The system environment value. You must provide this value in the name=value format."
        }
      ],
      "enabled": true,
      "output_schema": {
        "submission_type": "",
        "job_id": "",
        "submission_id": "",
        "environment_id": "",
        "sha256": ""
      }
    },
    {
      "operation": "url_quick_scan",
      "title": "Quick Scan URL",
      "category": "investigation",
      "annotation": "url_quick_scan",
      "description": "Submits a URL to the Hybrid Analysis server for a Quick Scan. You can query the Hybrid Analysis server again, in a few minutes, to check the results of the scan.",
      "parameters": [
        {
          "title": "URL",
          "name": "url_to_scan",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "The URL you want to scan",
          "description": "Specify URL that you want to scan in Hybrid Analysis server for analyzes."
        },
        {
          "title": "Comment",
          "name": "comment",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Comment text that may be associated with the submission/sample (Note: you can use #tags here)",
          "placeholder": "#tags",
          "description": "(Optional) A comment that you want to add when submitting the file."
        },
        {
          "title": "Submit Name",
          "name": "submit_name",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "Submission Name field that will be used for file type detection and analysis",
          "placeholder": "My Sample",
          "description": "(Optional) The name of the submitted file. The Submission Name field is used for file type detection and analysis."
        }
      ],
      "enabled": true,
      "output_schema": {
        "id": "",
        "reports": [],
        "finished": "",
        "scanners": [
          {
            "name": "",
            "total": "",
            "status": "",
            "percent": "",
            "progress": "",
            "positives": "",
            "error_message": "",
            "anti_virus_results": []
          }
        ],
        "whitelist": [],
        "scanners_v2": {
          "bfore_ai": {
            "name": "",
            "status": "",
            "percent": "",
            "progress": "",
            "error_message": ""
          },
          "clean_dns": {
            "name": "",
            "status": "",
            "reports": [],
            "progress": "",
            "error_message": "",
            "reports_count": ""
          },
          "urlscan_io": {
            "name": "",
            "status": "",
            "percent": "",
            "progress": "",
            "error_message": ""
          },
          "virustotal": "",
          "metadefender": "",
          "scam_adviser": {
            "name": "",
            "status": "",
            "percent": "",
            "progress": "",
            "error_message": ""
          },
          "crowdstrike_ml": ""
        },
        "submission_type": ""
      }
    },
    {
      "operation": "get_report",
      "title": "Get Analysis Report",
      "category": "investigation",
      "annotation": "get_analysis_report",
      "description": "Retrieves all the analysis details from the Hybrid Analysis server for a submitted file, based on the input parameters you specify.",
      "parameters": [
        {
          "title": "Job ID",
          "name": "job_id",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "ID of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the job ID when you submit a sample file. Note: If you provide Job ID then no need to provide File SHA256 and Environment ID",
          "description": "The ID of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the job ID when you submit a sample file.\nNote: If you specify the Job ID you do not require to specify File SHA256 or the environment ID."
        },
        {
          "title": "File SHA256",
          "name": "file_hash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "SHA256 value of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file. Note: If you provide File SHA256 then you should provide Environment ID and no need to provide Job ID.",
          "description": "SHA256 value of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file.\nNote: If you specify File SHA256, then you must specify the Environment ID.",
          "placeholder": "only SHA256"
        },
        {
          "title": "Environment ID",
          "name": "environmentId",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "ID of the environment on which the submitted file is to be run, whose report you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file. Note: If you provide Environment ID then you should provide File SHA256 and no need to provide Job ID",
          "description": "The ID of the environment on which the submitted file is to be run, whose report you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file.\nNote: If you specify Environment ID, then you must specify the File SHA256."
        }
      ],
      "enabled": true,
      "output_schema": {
        "md5": "",
        "sha1": "",
        "size": "",
        "tags": [],
        "type": "",
        "hosts": [],
        "state": "",
        "job_id": "",
        "sha256": "",
        "sha512": "",
        "ssdeep": "",
        "domains": [],
        "imphash": "",
        "verdict": "",
        "av_detect": "",
        "processes": [
          {
            "pid": "",
            "uid": "",
            "icon": "",
            "name": "",
            "sha256": "",
            "handles": [],
            "modules": [],
            "mutants": [],
            "streams": [],
            "av_label": "",
            "av_total": "",
            "registry": [],
            "parentuid": "",
            "amsi_calls": [],
            "av_matched": "",
            "command_line": "",
            "script_calls": [],
            "created_files": [],
            "file_accesses": [],
            "process_flags": [],
            "normalized_path": ""
          }
        ],
        "subsystem": "",
        "vx_family": "",
        "entrypoint": "",
        "error_type": "",
        "image_base": "",
        "signatures": [
          {
            "name": "",
            "type": "",
            "origin": "",
            "attck_id": "",
            "capec_id": "",
            "category": "",
            "relevance": "",
            "identifier": "",
            "description": "",
            "threat_level": "",
            "attck_id_wiki": "",
            "threat_level_human": ""
          }
        ],
        "target_url": "",
        "type_short": [],
        "interesting": "",
        "submissions": [
          {
            "url": "",
            "filename": "",
            "created_at": "",
            "submission_id": ""
          }
        ],
        "submit_name": "",
        "certificates": [],
        "error_origin": "",
        "mitre_attcks": [
          {
            "parent": "",
            "tactic": "",
            "attck_id": "",
            "technique": "",
            "attck_id_wiki": "",
            "malicious_identifiers": [],
            "suspicious_identifiers": [],
            "informative_identifiers": [],
            "malicious_identifiers_count": "",
            "suspicious_identifiers_count": "",
            "informative_identifiers_count": ""
          }
        ],
        "network_mode": "",
        "threat_level": "",
        "threat_score": "",
        "url_analysis": "",
        "file_metadata": "",
        "crowdstrike_ai": {
          "analysis_related_urls": [],
          "executable_process_memory_analysis": []
        },
        "environment_id": "",
        "extracted_files": [],
        "total_processes": "",
        "major_os_version": "",
        "minor_os_version": "",
        "total_signatures": "",
        "compromised_hosts": [],
        "entrypoint_section": "",
        "analysis_start_time": "",
        "classification_tags": [],
        "dll_characteristics": [],
        "is_certificates_valid": "",
        "environment_description": "",
        "machine_learning_models": [],
        "total_network_connections": "",
        "image_file_characteristics": [],
        "certificates_validation_message": ""
      }
    },
    {
      "operation": "conditional_search",
      "title": "Advanced Search",
      "category": "investigation",
      "annotation": "search_query",
      "description": "Retrieves all the reports from the Hybrid Analysis server that match the input parameters you specify.",
      "parameters": [
        {
          "title": "File Name",
          "name": "filename",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. invoice.exe",
          "description": "Name of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Name of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "File Type",
          "name": "filetype",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. docx",
          "description": "Type of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Type of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "File Type Description",
          "name": "filetype_desc",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. PE32 executable",
          "description": "Description of the file type based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Description of the file type based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Environment ID",
          "name": "env_id",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "The ID of the environment based on which you want to search for a report on the Hybrid Analysis.",
          "tooltip": "The ID of the environment based on which you want to search for a report on the Hybrid Analysis."
        },
        {
          "title": "Verdict",
          "name": "verdict",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Whitelisted",
            "No Verdict",
            "No Specific Threat",
            "Suspicious",
            "Malicious"
          ],
          "description": "Verdict of the Hybrid Analysis server after scanning the submitted file. Select one of the following as the verdict value: Whitelisted, No Verdict, No Specific Threat, Suspicious, or Malicious.",
          "tooltip": "Verdict of the Hybrid Analysis server after scanning the submitted file. Select one of the following as the verdict value: Whitelisted, No Verdict, No Specific Threat, Suspicious, or Malicious."
        },
        {
          "title": "AV Multiscan range",
          "name": "av_detect",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. 50-70 [min 0, max 100]",
          "description": "AV Multiscan range of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "AV Multiscan range of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "AV Family Substring",
          "name": "vx_family",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. nemucod",
          "description": "AV Family Substring of the file type based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "AV Family Substring of the file type based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Hash Tag",
          "name": "tag",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. ransomware",
          "description": "Hash tag of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Hash tag of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Port",
          "name": "port",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "placeholder": "e.g. 8080",
          "description": "Port of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Port of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Host",
          "name": "host",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. 192.168.0.1",
          "description": "Host of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Host of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Domain",
          "name": "domain",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. checkip.dyndns.org",
          "description": "Domain of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Domain of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "HTTP Request Substring",
          "name": "url",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. google",
          "description": "HTTP Request Substring of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "HTTP Request Substring of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Similar Samples",
          "name": "similar_to",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. <sha256>",
          "description": "Samples that are similar to the submitted file that you want to search for a report on the Hybrid Analysis server. For example, files having a similar SHA value.",
          "tooltip": "Samples that are similar to the submitted file that you want to search for a report on the Hybrid Analysis server. For example, files having a similar SHA value."
        },
        {
          "title": "Sample Context",
          "name": "context",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "placeholder": "e.g. <sha256>",
          "description": "Samples that have a similar context to the submitted file that you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Samples that have a similar context to the submitted file that you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Start DateTime",
          "name": "date_from",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp.",
          "type": "datetime",
          "visible": true,
          "editable": true,
          "required": false,
          "tooltip": "Select the DateTime using which you want to filter the result set to only include only those items that have been created after the specified timestamp."
        },
        {
          "title": "End DateTime",
          "name": "date_to",
          "description": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp.",
          "type": "datetime",
          "visible": true,
          "editable": true,
          "required": false,
          "tooltip": "Select the DateTime using which you want to filter the result set to only include only those items that have been created before the specified timestamp."
        },
        {
          "title": "IMP Hash",
          "name": "imp_hash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "IMP Hash of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "IMP Hash of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "SS Deep",
          "name": "ssdeep",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "SS Deep of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "SS Deep of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Authenti Hash",
          "name": "authentihash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "Authentihash of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Authentihash of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Uses Tactic",
          "name": "uses_tactic",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "Specify the MITRE ATT&CK® tactic of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Specify the MITRE ATT&CK® tactic of the file based on which you want to search for a report on the Hybrid Analysis server."
        },
        {
          "title": "Uses Technique",
          "name": "uses_technique",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "description": "Specify the MITRE ATT&CK® technique of the file based on which you want to search for a report on the Hybrid Analysis server.",
          "tooltip": "Specify the MITRE ATT&CK® technique of the file based on which you want to search for a report on the Hybrid Analysis server."
        }
      ],
      "enabled": true,
      "output_schema": {
        "count": "",
        "result": [
          {
            "vx_family": "",
            "verdict": "",
            "submit_name": "",
            "type_short": "",
            "job_id": "",
            "analysis_start_time": "",
            "environment_description": "",
            "threat_score": "",
            "av_detect": "",
            "sha256": "",
            "environment_id": "",
            "size": "",
            "type": ""
          }
        ],
        "search_terms": [
          {
            "id": "",
            "value": ""
          }
        ]
      }
    },
    {
      "operation": "get_sample_dropped_file",
      "title": "Get Files Dropped by Sample",
      "category": "investigation",
      "annotation": "get_file",
      "description": "Retrieves all the details of the dropped file from the Hybrid Analysis server and adds the file to the FortiSOAR™ Attachments module. You specify the sample for which you want to retrieve dropped files, based on the input parameters you have specified.",
      "parameters": [
        {
          "title": "Job ID",
          "name": "job_id",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "ID of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the job ID when you submit a sample file. Note: If you provide Job ID then no need to provide File SHA256 and Environment ID",
          "description": "The ID of the file for which you want to retrieve details of the dropped file from the Hybrid Analysis server. You can get the job ID when you submit a sample file.\nNote: If you specify the Job ID you do not require to specify File SHA256 or the environment ID."
        },
        {
          "title": "File SHA256",
          "name": "file_hash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "SHA256 value of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file. Note: If you provide File SHA256 then you should provide Environment ID and no need to provide Job ID.",
          "description": "SHA256 value of the file for which you want to retrieve details of the dropped file from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file.\nNote: If you specify File SHA256, then you must specify the Environment ID.",
          "placeholder": "only SHA256"
        },
        {
          "title": "Environment ID",
          "name": "environmentId",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "ID of the environment on which the submitted file is to be run, whose report you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file. Note: If you provide Environment ID then you should provide File SHA256 and no need to provide Job ID",
          "description": "The ID of the environment on which the submitted file is to be run, whose details of the dropped file you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file.\nNote: If you specify Environment ID, then you must specify the File SHA256."
        }
      ],
      "enabled": true,
      "output_schema": {
        "id": "",
        "@id": "",
        "file": {
          "id": "",
          "@id": "",
          "size": "",
          "uuid": "",
          "@type": "",
          "assignee": "",
          "filename": "",
          "metadata": [],
          "mimeType": "",
          "thumbnail": "",
          "uploadDate": ""
        },
        "name": "",
        "type": "",
        "uuid": "",
        "@type": "",
        "@context": "",
        "assignee": "",
        "createDate": "",
        "createUser": {
          "id": "",
          "@id": "",
          "name": "",
          "uuid": "",
          "@type": "",
          "avatar": "",
          "userId": "",
          "userType": "",
          "createDate": "",
          "createUser": "",
          "modifyDate": "",
          "modifyUser": ""
        },
        "modifyDate": "",
        "modifyUser": {
          "id": "",
          "@id": "",
          "name": "",
          "uuid": "",
          "@type": "",
          "avatar": "",
          "userId": "",
          "userType": "",
          "createDate": "",
          "createUser": "",
          "modifyDate": "",
          "modifyUser": ""
        },
        "recordTags": [],
        "description": ""
      }
    },
    {
      "operation": "get_sample_screenshots",
      "title": "Get Sample Screenshot",
      "category": "investigation",
      "annotation": "get_sample_screenshots",
      "description": "Retrieves screenshots of specified submitted samples that are captured during analysis from the Hybrid Analysis server. You specify the sample for which you want to retrieve screenshots based on the input parameters you have specified. You can optionally also add the screenshots to the FortiSOAR™ Attachments module.",
      "parameters": [
        {
          "title": "Job ID",
          "name": "job_id",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "ID of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the job ID when you submit a sample file. Note: If you provide Job ID then no need to provide File SHA256 and Environment ID",
          "description": "The ID of the file for which you want to retrieve screenshots that are captured during analysis from the Hybrid Analysis server. You can get the job ID when you submit a sample file.\nNote: If you specify the Job ID you do not require to specify File SHA256 or the environment ID."
        },
        {
          "title": "File SHA256",
          "name": "file_hash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "SHA256 value of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file. Note: If you provide File SHA256 then you should provide Environment ID and no need to provide Job ID.",
          "description": "SHA256 value of the file for which you want to retrieve screenshots that are captured during analysis from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file.\nNote: If you specify File SHA256, then you must specify the Environment ID.",
          "placeholder": "only SHA256"
        },
        {
          "title": "Environment ID",
          "name": "environmentId",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "ID of the environment on which the submitted file is to be run, whose report you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file. Note: If you provide Environment ID then you should provide File SHA256 and no need to provide Job ID",
          "description": "The ID of the environment on which the submitted file is to be run, whose screenshots you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file.\nNote: If you specify Environment ID, then you must specify the File SHA256."
        },
        {
          "title": "Attach Screenshots to FortiSOAR",
          "name": "is_attach",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "checkbox",
          "value": false,
          "description": "If you select this option, i.e. set it to True, then the sample screenshots are added to the FortiSOAR™ Attachments module.\nBy default, this is set to, False.",
          "tooltip": "If you select this option, i.e. set it to True, then the sample screenshots are added to the FortiSOAR™ Attachments module.\nBy default, this is set to, False."
        }
      ],
      "enabled": true,
      "output_schema": [
        {
          "name": "",
          "image": "",
          "date": ""
        }
      ]
    },
    {
      "operation": "get_submitted_sample_state",
      "title": "Get Submission State",
      "category": "investigation",
      "annotation": "get_submitted_sample_state",
      "description": "Retrieves the state of a submitted file from the Hybrid Analysis server, based on the input parameters you have specified.",
      "parameters": [
        {
          "title": "Job ID",
          "name": "job_id",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "ID of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the job ID when you submit a sample file. Note: If you provide Job ID then no need to provide File SHA256 and Environment ID",
          "description": "The ID of the submitted file for which you want to retrieve the state information from the Hybrid Analysis server. You can get the job ID when you submit a sample file.\nNote: If you specify the Job ID you do not require to specify File SHA256 or the environment ID."
        },
        {
          "title": "File SHA256",
          "name": "file_hash",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "tooltip": "SHA256 value of the file for which you want to retrieve a report from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file. Note: If you provide File SHA256 then you should provide Environment ID and no need to provide Job ID.",
          "description": "SHA256 value of the submitted file for which you want to retrieve the state information from the Hybrid Analysis server. You can get the SHA256 value when you submit a sample file.\nNote: If you specify File SHA256, then you must specify the Environment ID.",
          "placeholder": "only SHA256"
        },
        {
          "title": "Environment ID",
          "name": "environmentId",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "tooltip": "ID of the environment on which the submitted file is to be run, whose report you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file. Note: If you provide Environment ID then you should provide File SHA256 and no need to provide Job ID",
          "description": "The ID of the environment on which the submitted file is to be run, whose state information you want to retrieve from the Hybrid Analysis server. You can get the Environment ID when you submit a sample file.\nNote: If you specify Environment ID, then you must specify the File SHA256."
        }
      ],
      "enabled": true,
      "output_schema": {
        "state": "",
        "error_type": "",
        "error_origin": "",
        "error": "",
        "related_reports": []
      }
    },
    {
      "operation": "get_feed",
      "title": "Get Latest Analysis Reports",
      "category": "investigation",
      "annotation": "get_latest_analysis_reports",
      "description": "Retrieves a list of reports from the Hybrid Analysis server.",
      "parameters": [],
      "enabled": true,
      "output_schema": {
        "count": "",
        "status": "",
        "data": [
          {
            "job_id": "",
            "md5": "",
            "sha1": "",
            "sha256": "",
            "interesting": "",
            "analysis_start_time": "",
            "threat_score": "",
            "threat_level": "",
            "threat_level_human": "",
            "av_detect": "",
            "unknown": "",
            "submit_name": "",
            "url_analysis": "",
            "size": "",
            "type": "",
            "environment_id": "",
            "environment_description": "",
            "shared_analysis": "",
            "reliable": "",
            "report_url": "",
            "vt_detect": "",
            "ms_detect": "",
            "processes": [
              {
                "uid": "",
                "name": "",
                "normalized_path": "",
                "command_line": "",
                "sha256": ""
              }
            ],
            "ssdeep": ""
          }
        ]
      }
    },
    {
      "operation": "get_api_quota",
      "title": "Get API Quota",
      "category": "investigation",
      "annotation": "get_api_quota",
      "description": "Retrieves details of the API quota for the specified user account from the Hybrid Analysis server. You specify the user account when you are configuring the Hybrid Analysis connector.",
      "parameters": [],
      "enabled": true,
      "output_schema": {
        "detonation": {
          "total": "",
          "apikey": {
            "quota": {
              "hour": "",
              "day": "",
              "week": "",
              "month": "",
              "year": "",
              "omega": ""
            },
            "used": {
              "hour": "",
              "day": "",
              "week": "",
              "month": "",
              "year": "",
              "omega": ""
            },
            "available": {
              "hour": "",
              "day": "",
              "week": "",
              "month": "",
              "year": "",
              "omega": ""
            },
            "quota_reached": ""
          },
          "quota_reached": ""
        },
        "quick_scan": {
          "total": "",
          "apikey": "",
          "quota_reached": ""
        }
      }
    }
  ],
  "icon_medium_name": "",
  "cs_approved": true,
  "cs_compatible": true,
  "help_online": ""
}